<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Murdered.</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

<style>
    body {
        margin: 0;
        background: radial-gradient(circle at center, #111 0%, #050505 100%);
        color: #eaeaea;
        font-family: "Georgia", serif;
        overflow-x: hidden;
        perspective: 1200px;
    }

    section {
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 2rem;
    }

    h1 {
        font-size: 4.5rem;
        letter-spacing: 0.15em;
        opacity: 0;
        animation: fadeInTitle 4s ease forwards;
    }

    @keyframes fadeInTitle {
        to { opacity: 1; }
    }

    p {
        max-width: 750px;
        font-size: 1.25rem;
        line-height: 1.8;
        opacity: 0;
        transition: opacity 3s ease;
    }

    .visible { opacity: 1; }

    .question {
        color: #aa0000;
        font-size: 2.1rem;
        margin-top: 2rem;
        font-weight: bold;
        opacity: 0;
        animation: flicker 0.15s infinite alternate;
    }

    @keyframes flicker {
        from { opacity: 0.5; }
        to { opacity: 1; }
    }

    /* Jumpscare overlay */
    .jumpscare {
        position: fixed;
        inset: 0;
        background: black;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 999;
        opacity: 0;
        pointer-events: none;
    }

    .knife {
        width: 200px;
        transform: scale(0.1) rotateY(0deg);
    }

    .flash {
        position: fixed;
        inset: 0;
        background: white;
        opacity: 0;
        z-index: 1000;
        pointer-events: none;
    }
</style>
</head>
<body>

<section>
    <h1>Murdered.</h1>
</section>

<section>
    <div>
        <p id="story">
            I was sitting alone, tiny lamp illuminating the desk in front of me.
            A text from my phone lights up my features,
            I read it and ponder upon the words written upon the screen.
        </p>

        <p class="question" id="question">
            If you were to be murdered, how would you like to go?
        </p>
    </div>
</section>

<!-- Jumpscare -->
<div class="jumpscare" id="jumpscare">
    <svg class="knife" id="knife" viewBox="0 0 100 300">
        <path d="M50 10 L65 200 L35 200 Z"
              fill="silver" stroke="#ccc" stroke-width="2"/>
        <rect x="40" y="200" width="20" height="80"
              fill="#222"/>
    </svg>
</div>

<div class="flash" id="flash"></div>

<script>
const story = document.getElementById("story");
const question = document.getElementById("question");
const jumpscare = document.getElementById("jumpscare");
const knife = document.getElementById("knife");
const flash = document.getElementById("flash");

const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
        if (entry.isIntersecting) {

            story.classList.add("visible");

            setTimeout(() => {
                question.style.opacity = "1";
                startHeartbeat();

                // 5s later â†’ silence then jumpscare
                setTimeout(() => {
                    stopHeartbeat();

                    setTimeout(() => {
                        triggerJumpScare();
                    }, 1500);

                }, 5000);

            }, 3000);

            observer.disconnect();
        }
    });
}, { threshold: 0.6 });

observer.observe(story);

let heartbeatInterval;
let audioCtx;

function startHeartbeat() {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function beat() {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = "sine";
        osc.frequency.setValueAtTime(80, audioCtx.currentTime);
        gain.gain.setValueAtTime(1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.15);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.15);
    }

    heartbeatInterval = setInterval(() => {
        beat();
        setTimeout(beat, 250);
    }, 1200);
}

function stopHeartbeat() {
    clearInterval(heartbeatInterval);
}

function triggerJumpScare() {
    jumpscare.style.opacity = "1";

    playStabSound();

    // white flash
    gsap.to(flash, { opacity: 1, duration: 0.05 });
    gsap.to(flash, { opacity: 0, duration: 0.2, delay: 0.05 });

    // aggressive zoom toward viewer
    gsap.to(knife, {
        scale: 8,
        rotationY: 720,
        duration: 0.4,
        ease: "power4.out"
    });

    // cut to black
    setTimeout(() => {
        gsap.to("body", { backgroundColor: "black", duration: 0.5 });
        jumpscare.style.opacity = "0";
    }, 600);
}

function playStabSound() {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();

    const osc = ctx.createOscillator();
    const gain = ctx.createGain();

    osc.type = "sawtooth";
    osc.frequency.setValueAtTime(200, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(40, ctx.currentTime + 0.3);

    gain.gain.setValueAtTime(1, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.4);

    osc.connect(gain);
    gain.connect(ctx.destination);

    osc.start();
    osc.stop(ctx.currentTime + 0.4);
}
</script>

</body>
</html>

