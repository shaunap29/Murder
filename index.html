<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Murdered.</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

<style>
body {
    margin: 0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
}

/* Phone frame */
.phone {
    width: 320px;
    height: 640px;
    background: #111;
    border-radius: 40px;
    box-shadow: 0 0 40px rgba(0,0,0,0.8);
    overflow: hidden;
    position: relative;
}

/* Screen */
.screen {
    padding: 20px;
    color: #fff;
    height: 100%;
    overflow-y: auto;
    box-sizing: border-box;
}

/* Messages */
.message {
    margin-bottom: 15px;
    padding: 10px 14px;
    border-radius: 18px;
    max-width: 80%;
    opacity: 0;
}

.sent {
    background: #333;
    align-self: flex-end;
}

.received {
    background: #1c1c1c;
}

.red {
    background: #330000;
    color: #ff2a2a;
    font-weight: bold;
    font-size: 1.1rem;
}

/* Glitch */
.glitch {
    animation: glitch 0.15s infinite alternate;
}

@keyframes glitch {
    from { transform: translateX(-1px); }
    to { transform: translateX(1px); }
}

/* Jumpscare overlay */
.jumpscare {
    position: fixed;
    inset: 0;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 999;
    opacity: 0;
}

.knife {
    width: 150px;
    transform: scale(0.1);
}

.flash {
    position: fixed;
    inset: 0;
    background: white;
    opacity: 0;
    z-index: 1000;
}
</style>
</head>
<body>

<div class="phone">
    <div class="screen" id="screen">
        <div class="message received" id="m1">
            I was sitting alone, tiny lamp illuminating the desk in front of me.
        </div>
        <div class="message received" id="m2">
            A text from my phone lights up my features.
        </div>
        <div class="message received" id="m3">
            I read it and ponder upon the words written upon the screen.
        </div>
        <div class="message received red" id="question">
            If you were to be murdered, how would you like to go?
        </div>
    </div>
</div>

<div class="jumpscare" id="jumpscare">
    <svg class="knife" id="knife" viewBox="0 0 100 300">
        <path d="M50 10 L65 200 L35 200 Z"
              fill="silver" stroke="#ccc" stroke-width="2"/>
        <rect x="40" y="200" width="20" height="80"
              fill="#222"/>
    </svg>
</div>

<div class="flash" id="flash"></div>

<script>
const messages = ["m1","m2","m3"];
const question = document.getElementById("question");
const jumpscare = document.getElementById("jumpscare");
const knife = document.getElementById("knife");
const flash = document.getElementById("flash");

let audioCtx;
let heartbeatInterval;

function showMessage(id, delay) {
    setTimeout(() => {
        gsap.to("#"+id, {opacity: 1, duration: 1});
    }, delay);
}

// Sequential message reveal
showMessage("m1", 1000);
showMessage("m2", 3000);
showMessage("m3", 5000);

// Red question after 3 seconds more
setTimeout(() => {
    gsap.to(question, {opacity: 1, duration: 1});
    question.classList.add("glitch");
    startHeartbeat();

    // Silence after 5 seconds
    setTimeout(() => {
        stopHeartbeat();

        setTimeout(() => {
            triggerJumpScare();
        }, 1500);

    }, 5000);

}, 8000);

function startHeartbeat() {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    function beat() {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = "sine";
        osc.frequency.setValueAtTime(80, audioCtx.currentTime);
        gain.gain.setValueAtTime(1, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.15);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.15);
    }

    heartbeatInterval = setInterval(() => {
        beat();
        setTimeout(beat, 250);
    }, 1200);
}

function stopHeartbeat() {
    clearInterval(heartbeatInterval);
}

function triggerJumpScare() {
    jumpscare.style.opacity = "1";
    playStab();

    gsap.to(flash, {opacity:1, duration:0.05});
    gsap.to(flash, {opacity:0, duration:0.2, delay:0.05});

    gsap.to(knife, {
        scale: 10,
        duration: 0.4,
        ease: "power4.out"
    });

    setTimeout(() => {
        document.body.style.background = "black";
        jumpscare.style.opacity = "0";
    }, 600);
}

function playStab() {
    const ctx = new (window.AudioContext || window.webkitAudioContext)();
    const osc = ctx.createOscillator();
    const gain = ctx.createGain();
    osc.type = "sawtooth";
    osc.frequency.setValueAtTime(200, ctx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(40, ctx.currentTime + 0.3);
    gain.gain.setValueAtTime(1, ctx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, ctx.currentTime + 0.4);
    osc.connect(gain);
    gain.connect(ctx.destination);
    osc.start();
    osc.stop(ctx.currentTime + 0.4);
}
</script>

</body>
</html>

